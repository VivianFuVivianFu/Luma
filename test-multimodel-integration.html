<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Model System Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1e3a8a, #7c3aed);
            color: white;
            min-height: 100vh;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .test-input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
        }
        .test-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        .test-button {
            background: linear-gradient(45deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .response-area {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin: 10px 0;
            min-height: 100px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
        }
        .status.success { background: rgba(34, 197, 94, 0.3); }
        .status.error { background: rgba(239, 68, 68, 0.3); }
        .status.info { background: rgba(59, 130, 246, 0.3); }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü§ñ Multi-Model System Integration Test</h1>
        
        <div class="test-section">
            <h3>üß† System Status</h3>
            <button class="test-button" onclick="checkSystemStatus()">Check System Status</button>
            <div id="systemStatus" class="response-area">Click "Check System Status" to see if the multi-model system is working...</div>
        </div>
        
        <div class="test-section">
            <h3>üí¨ Test Chat Messages</h3>
            <p>Test different types of messages to see which model gets selected:</p>
            
            <div>
                <h4>Emotional Support Test</h4>
                <button class="test-button" onclick="testMessage('I feel really sad and overwhelmed today')">Test Emotional Message</button>
            </div>
            
            <div>
                <h4>Logical Reasoning Test</h4>
                <button class="test-button" onclick="testMessage('Can you help me analyze the pros and cons of changing careers?')">Test Reasoning Message</button>
            </div>
            
            <div>
                <h4>Crisis Detection Test</h4>
                <button class="test-button" onclick="testMessage('I feel hopeless and don\\'t know what to do')">Test Crisis Message</button>
            </div>
            
            <div>
                <h4>Custom Message Test</h4>
                <input type="text" id="customMessage" class="test-input" placeholder="Enter your test message here..." />
                <button class="test-button" onclick="testCustomMessage()">Test Custom Message</button>
            </div>
            
            <div id="testResults" class="response-area">Test results will appear here...</div>
        </div>
        
        <div class="test-section">
            <h3>üìä System Metrics</h3>
            <button class="test-button" onclick="getMetrics()">Get Performance Metrics</button>
            <div id="metricsDisplay" class="response-area">Metrics will appear here...</div>
        </div>
        
        <div class="test-section">
            <h3>‚öôÔ∏è System Controls</h3>
            <button class="test-button" onclick="toggleMultiModel()">Toggle Multi-Model System</button>
            <button class="test-button" onclick="clearSystem()">Clear System Memory</button>
            <div id="controlStatus" class="response-area">Control actions will be logged here...</div>
        </div>
    </div>

    <script>
        // Test functions for the multi-model system
        let isMultiModelEnabled = true;
        
        async function checkSystemStatus() {
            const statusDiv = document.getElementById('systemStatus');
            statusDiv.innerHTML = 'Checking system status...';
            
            try {
                // This would connect to your actual LUMA API
                // For now, we'll simulate the check
                const status = {
                    multiModelEnabled: isMultiModelEnabled,
                    memoryEnabled: true,
                    modelsAvailable: ['Triage', 'Empathy', 'Reasoning'],
                    apiConnections: {
                        huggingFace: 'Connected',
                        togetherAI: 'Connected'
                    }
                };
                
                statusDiv.innerHTML = `System Status: ${isMultiModelEnabled ? '‚úÖ ACTIVE' : '‚ùå DISABLED'}
                
Multi-Model System: ${status.multiModelEnabled ? 'Enabled' : 'Disabled'}
Memory System: ${status.memoryEnabled ? 'Enabled' : 'Disabled'}
Available Models: ${status.modelsAvailable.join(', ')}

API Connections:
- Hugging Face: ${status.apiConnections.huggingFace}
- Together AI: ${status.apiConnections.togetherAI}

Status: ${isMultiModelEnabled ? 'Ready to route messages to specialized models!' : 'Using fallback responses only'}`;
                
            } catch (error) {
                statusDiv.innerHTML = `‚ùå Error checking status: ${error.message}`;
            }
        }
        
        async function testMessage(message) {
            const resultsDiv = document.getElementById('testResults');
            resultsDiv.innerHTML = `Testing message: "${message}"\nProcessing...`;
            
            try {
                // Simulate the multi-model routing
                const result = await simulateMultiModelResponse(message);
                
                resultsDiv.innerHTML = `‚úÖ Test Complete!

Input: "${message}"
Triage Classification: ${result.triageType}
Selected Model: ${result.model}
Confidence: ${(result.confidence * 100).toFixed(1)}%
Response Time: ${result.responseTime}ms

Response: "${result.response}"

Routing Decision: ${result.routingReason}`;
                
            } catch (error) {
                resultsDiv.innerHTML = `‚ùå Test failed: ${error.message}`;
            }
        }
        
        async function testCustomMessage() {
            const customMessage = document.getElementById('customMessage').value;
            if (!customMessage.trim()) {
                alert('Please enter a message to test');
                return;
            }
            await testMessage(customMessage);
        }
        
        async function getMetrics() {
            const metricsDiv = document.getElementById('metricsDisplay');
            metricsDiv.innerHTML = 'Fetching metrics...';
            
            // Simulate metrics
            const metrics = {
                totalRequests: 25,
                successfulResponses: 23,
                averageResponseTime: 420,
                modelUsage: {
                    empathy: 15,
                    reasoning: 8,
                    fallback: 2
                },
                routingAccuracy: 92
            };
            
            metricsDiv.innerHTML = `üìä System Performance Metrics

Total Requests: ${metrics.totalRequests}
Successful Responses: ${metrics.successfulResponses}
Success Rate: ${((metrics.successfulResponses / metrics.totalRequests) * 100).toFixed(1)}%
Average Response Time: ${metrics.averageResponseTime}ms

Model Usage:
- Empathy Model: ${metrics.modelUsage.empathy} requests
- Reasoning Model: ${metrics.modelUsage.reasoning} requests  
- Fallback Responses: ${metrics.modelUsage.fallback} requests

Routing Accuracy: ${metrics.routingAccuracy}%

System Health: ${metrics.successfulResponses / metrics.totalRequests > 0.8 ? 'üü¢ HEALTHY' : 'üü° DEGRADED'}`;
        }
        
        function toggleMultiModel() {
            isMultiModelEnabled = !isMultiModelEnabled;
            const controlDiv = document.getElementById('controlStatus');
            controlDiv.innerHTML = `Multi-Model System ${isMultiModelEnabled ? 'ENABLED' : 'DISABLED'}
            
${isMultiModelEnabled ? 
'‚úÖ Messages will be routed to specialized models (Empathy/Reasoning)' : 
'‚ö†Ô∏è System will use fallback responses only'}`;
        }
        
        function clearSystem() {
            const controlDiv = document.getElementById('controlStatus');
            controlDiv.innerHTML = `üßπ System Memory Cleared
            
- Conversation history reset
- Model routing statistics cleared  
- Memory system reinitialized
- Performance metrics reset

Status: Ready for new conversations`;
        }
        
        // Simulate multi-model system response
        async function simulateMultiModelResponse(message) {
            // Simulate processing delay
            await new Promise(resolve => setTimeout(resolve, 300 + Math.random() * 400));
            
            const lowerMessage = message.toLowerCase();
            
            // Simulate triage classification
            let triageType, model, confidence, routingReason;
            
            if (lowerMessage.includes('sad') || lowerMessage.includes('overwhelmed') || 
                lowerMessage.includes('feel') || lowerMessage.includes('hopeless')) {
                triageType = 'emotional';
                model = 'empathy';
                confidence = 0.85 + Math.random() * 0.15;
                routingReason = lowerMessage.includes('hopeless') ? 'crisis_detected' : 'emotional_content_detected';
            } else if (lowerMessage.includes('analyze') || lowerMessage.includes('pros and cons') || 
                       lowerMessage.includes('help me think') || lowerMessage.includes('decision')) {
                triageType = 'logical';
                model = 'reasoning';
                confidence = 0.80 + Math.random() * 0.20;
                routingReason = 'logical_analysis_requested';
            } else {
                triageType = 'neutral';
                model = Math.random() > 0.5 ? 'empathy' : 'reasoning';
                confidence = 0.50 + Math.random() * 0.30;
                routingReason = 'neutral_content_default_routing';
            }
            
            // Generate appropriate response
            let response;
            if (model === 'empathy') {
                const empathyResponses = [
                    "I can hear the emotion in your words, and I want you to know that your feelings are valid. I'm here to listen and support you through this.",
                    "Thank you for sharing something so personal with me. It takes courage to open up about difficult feelings. How can I best support you right now?",
                    "I can sense this is weighing heavily on you. Sometimes just having someone acknowledge what you're going through can help. I'm here with you."
                ];
                response = empathyResponses[Math.floor(Math.random() * empathyResponses.length)];
            } else {
                const reasoningResponses = [
                    "Let's approach this systematically. First, we should clearly define what the core issue is, then identify potential causes, and finally explore different solution strategies.",
                    "To help you make this decision, let's consider the key factors involved. I can help you create a structured comparison to guide your choice.",
                    "I can help you think through this logically. Let me break down the key elements and provide a structured analysis."
                ];
                response = reasoningResponses[Math.floor(Math.random() * reasoningResponses.length)];
            }
            
            return {
                triageType,
                model,
                confidence,
                routingReason,
                response,
                responseTime: Math.floor(300 + Math.random() * 400)
            };
        }
        
        // Initialize page
        window.onload = function() {
            checkSystemStatus();
        };
    </script>
</body>
</html>